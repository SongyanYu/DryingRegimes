axis.title = element_text(size=14),
axis.text  = element_text(size = 10)),
#Legend Options
theme(legend.position = "bottom",
legend.title = element_text(size=14),
legend.text = element_text(size=10))
)
}
# Summarize Data
##Kmeans
library(dplyr)
tt <- df  %>%
group_by(dry_date_start,df) %>%
summarise(n = sum(df)) %>%
mutate(percentage = round(n / sum(n),4))
tt <- df  %>%
group_by(dry_date_start,kmeans) %>%
summarise(n = sum(kmeans)) %>%
mutate(percentage = round(n / sum(n),4))
k = ggplot(tt, aes(x=dry_date_start, y=percentage, fill=factor(kmeans.clust))) +
geom_area(size=.5, colour="black")+
scale_fill_manual(values=cols,"Cluster Membership")+
ggtitle("Kmeans")+
plot_lay()
k
k = ggplot(tt, aes(x=dry_date_start, y=percentage, fill=factor(kmeans))) +
geom_area(size=.5, colour="black")+
scale_fill_manual(values=cols,"Cluster Membership")+
ggtitle("Kmeans")+
plot_lay()
k
temp <- df  %>%
group_by(dry_date_start,kmeans) %>%
summarise(n = sum(kmeans)) %>%
mutate(percentage = round(n / sum(n),4))
kmeans.stacked = ggplot(temp, aes(x=dry_date_start, y=percentage, fill=factor(kmeans))) +
geom_area(size=.5, colour="black")+
scale_fill_manual(values=cols,"Cluster Membership")+
ggtitle("Kmeans")+
plot_lay()
kmeans.stacked
ggplot(data=df)+
geom_boxplot(aes(x=paste('kmeans',factor(kmeans)),y=metric,group=kmeans,fill = factor(kmeans)),outlier.colour = NA)+
scale_fill_manual(values = cols,"Cluster Membership")
bp <- function(metric){
ggplot(data=df)+
geom_boxplot(aes(x=paste('kmeans',factor(kmeans)),y=metric,group=kmeans,fill = factor(kmeans)),outlier.colour = NA)+
scale_fill_manual(values = cols,"Cluster Membership")
}
peak2zero = bp(df$peak2zero)+
ylim(c(0,100))+
ylab("Peak2Zero\n(Days)")
drying_rate = bp(df$drying_rate) +
ylim(0,2)+
ylab("Drying Rate\n(1/Days)")
dry_date_start = bp(df$dry_date_start)+
ylab("Dry Date Start\n(Day of Year)")
dry_dur = bp(df$dry_dur) +
ylim(c(0,500))+
ylab("Dry Duration\n(Days)")
peakQ = bp(df$peak_quantile)+
ylab("Peak Quantile")
ann_freq = bp(df$freq_local)+
ylab("Relative Event Frequency")
p = peak2zero  + drying_rate + dry_date_start + dry_dur + peakQ + ann_freq +
plot_layout(ncol = 2, guides = "collect") &
theme_light() &
labs(x=NULL)
p
library(ggplot2)
library(ggmap)
library(maps)
library(mapdata)
library(dplyr)
library(scales)
library(maptools)
library(dataRetrieval)
library(viridis)
library(gridExtra)
df = read.csv("../data/kmeans.csv")
states <- map_data("state")
dist<- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
ylab('Mean Number of Drying Events\n(days)\nlat') +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
geom_point(data=df, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS), colour = Name), size = 2, alpha=1)
dist
########## Load Data #############
df = read.csv("../data/kmeans.csv")
######## Plots ##########
# Color scales
cols <-
c("1" = "#4477AA",
"2" = "#66CCEE",
"3" = "#228833",
"4" = "#CCBB44",
"5" = "#EE6677",
"6" = "#AA3377",
"7" = "#BBBBBB",
"8" = "#999944",
"9" = "#332288")
ggplot() + geom_point(aes(x=y,y=y,colour=factor(y)),size=4)+ scale_color_manual(values = cols)
pal_regions <-
c("Eastern Forests" = "#009E73",
"Mediterranean California" = "#F0E442",
"Northern Great Plains" = "#0072B2",
"Southern Great Plains" = "#E69F00",
"Western Deserts" = "#D55E00",
"Western Mountains" = "#56B4E9")
mode <- function(x) {
ux <- unique(x)
ux[which.max(tabulate(match(x, ux)))]
}
noCoor = df[is.na(df$dec_lat_va),]
View(kmeans.stacked)
View(noCoor)
library(rwrfhydro)
gages2Attr
gages2Attr$STAID = noCoor$gage
gages2Attr$STAID = noCoor$gage[1]
gages2Attr
library(rwrfhydro)
gages2Attr
rm(gages2Attr)
library(rwrfhydro)
gages2Attr
tt = gages2Attr
View(tt)
tt$STAID >1
as.integer(tt$STAID)
as.numeric(tt$STAID)
tt$STAID = as.numeric(tt$STAID)
tt$STAID >1
tt$STAID == 208111310
tt[tt$STAID == 208111310,]
noCoor = unique(noCoor$gage)
tt[tt$STAID == noCoor,]
left_join(noCoor,tt,by='gage'='STAID')
left_join(noCoor,tt,by=c('gage'='STAID'))
noCoor = as.numeric(unique(noCoor$gage))
noCoor = df[is.na(df$dec_lat_va),]
noCoor = as.numeric(unique(noCoor$gage))
left_join(noCoor,tt,by=c('gage'='STAID'))
noCoor = df[is.na(df$dec_lat_va),]
tt = gages2Attr
tt$STAID = as.numeric(tt$STAID)
noCoor = unique(noCoor$gage)
tt$STAID = as.integer(as.numeric(tt$STAID))
tt$STAID
left_join(noCoor,tt,by=c('gage'='STAID'))
tt = gages2Attr
tt$STAID = as.integer(levels(tt$STAID)[tt$STAID]
tt = gages2Attr
tt$STAID = as.integer(levels(tt$STAID))[tt$STAID]
noCoor = unique(noCoor$gage)
left_join(noCoor,tt,by=c('gage'='STAID'))
tt$STAID = as.integer(levels(tt$STAID))
tt = gages2Attr
tt$STAID = as.integer(levels(tt$STAID))
levels(tt$STAID)
tt = gages2Attr
tt$STAID = strtoi(tt$STAID)
tt = gages2Attr
tt$STAID = strtoi(tt$STAID)
tt = gages2Attr
tt$STAID = integer(tt$STAID)
tt = gages2Attr
tt$STAID = integer(tt$STAID)
tt$STAID = as.integer(tt$STAID)
summary(tt)
noCoor = unique(noCoor$gage)
left_join(noCoor,tt,by=c('gage'='STAID'))
type(tt$STAID)
typeof(tt$STAID)
typeof(noCoor)
tt[tt$STAID==noCoor,]
tt[tt$STAID==noCoor[2],]
tt[tt$STAID==noCoor[1],]
tt[tt$STAID==noCoor[3],]
tt[tt$STAID==noCoor[4],]
tt[which(tt$STAID==noCoor[4]),]
tt[which(tt$STAID==noCoor),]
filter(tt,STAID=noCoor)
filter(tt,STAID==noCoor)
noCoor = df[is.na(df$dec_lat_va),]
library(rwrfhydro)
tt = gages2Attr
tt$STAID = as.integer(tt$STAID)
noCoor = as.data.frame(unique(noCoor$gage))
filter(tt,STAID==noCoor)
View(noCoor)
colnames(noCoor) = 'gage'
View(noCoor)
filter(tt,STAID==noCoor)
left_join(noCoor,tt,by=c('gage'='STAID'))
coors = left_join(noCoor,tt,by=c('gage'='STAID'))
View(coors)
df %>% filter(gage=noCoor)
df %>% filter(gage==noCoor)
noCoor = as.data.frame(unique(df$gage))
colnames(noCoor) = 'gage'
coors = left_join(noCoor,tt,by=c('gage'='STAID'))
View(coors)
df$dec_lat_va
df$dec_lat_va = coors$LAT_GAGE
noCoor = as.data.frame(df$gage)
colnames(noCoor) = 'gage'
coors = left_join(noCoor,tt,by=c('gage'='STAID'))
View(coors)
df$dec_lat_va = coors$LAT_GAGE
df$dec_long_va = coors$LNG_GAGE
df$dec_lat_va
k.means  = df  %>% group_by(gage) %>% summarise(kmeans.mode = mode(kmeans),
kmeans.unique = n_distinct(kmeans.clust))
k.means  = df  %>% group_by(gage) %>% summarise(kmeans.mode = mode(kmeans),
kmeans.unique = n_distinct(kmeans))
k.means %>% group_by(gage,kmeans.mode)
k.means %>% group_by(gage,kmeans)
df %>% group_by(gage,kmeans)
df %>% group_by(gage,kmeans) %>% summarise(tt = n())
df %>% group_by(gage,kmeans) %>% summarise(tt = n()/sum())
df %>% group_by(gage,kmeans) %>% summarise(tt = n())
df$n
df %>% group_by(gage,kmeans) %>% summarise(tt = n()/n)
df %>% group_by(gage,kmeans,n) %>% summarise(tt = n())
df %>% group_by(gage,kmeans,n) %>% summarise(tt = n(kmeans)/n)
df %>% group_by(gage,kmeans,n) %>% summarise(tt = n())
prop = df %>% group_by(gage,kmeans,n) %>% summarise(tt = n())
k.means  = df  %>% group_by(gage) %>% summarise(kmeans.mode = mode(kmeans),
kmeans.unique = n_distinct(kmeans))
k.means$prop = prop$tt/prop$n
yy = k.means %>% left_join(.,prop,by=c("gage","kmeans.mode"="kmeans"))
View(yy)
View(prop)
prop = df %>% group_by(gage,kmeans,n) %>% summarise(kmeans.count = n())
k.means  = df  %>% group_by(gage) %>% summarise(kmeans.mode = mode(kmeans),
kmeans.unique = n_distinct(kmeans))
yy = k.means %>% left_join(.,prop,by=c("gage","kmeans.mode"="kmeans"))
k.means = k.means %>% left_join(.,prop,by=c("gage","kmeans.mode"="kmeans"))
k.means$prop = k.means$kmeans.count/k.means$n
View(k.means)
colnames(k.means)  = c("gage",'mode','unique_membership','total_events','mode_count','proportion')
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
# geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion),alpha=1)+
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),colour = factor(mode), size = proportion),alpha=.7)+
scale_color_manual(name = "Cluster Membership Mode",values = cols)+
# scale_radius(trans='sqrt',breaks = c(.2,.4,.6,.8,1),labels = c(5,4,3,2,1),name = "Number of Cluster Changes") +
scale_shape(name="Gage Type")+
ggtitle("k-means")
kmean_CLUST
df %>% select(gage,dec_lat_va,dec_long_va) %>% left_join(.,k.means,by="gage")
df %>% select(gage,dec_lat_va,dec_long_va) %>% right_join(.,k.means,by="gage")
df %>% select(gage,dec_lat_va,dec_long_va) %>% left_join(k.means,.,by="gage")
tt = df %>% select(gage,dec_lat_va,dec_long_va) %>% left_join(k.means,.,by="gage")
tt
View(tt)
tt = df %>% select(gage,dec_lat_va,dec_long_va) %>% inner_join(k.means,.,by="gage")
tt = df %>% select(gage,dec_lat_va,dec_long_va,CLASS,Name) %>% left_join(k.means,.,by="gage")
tt = df %>% select(gage,dec_lat_va,dec_long_va,CLASS,Name) %>% left_join(k.means,.,by="gage") %?% unique()
tt = df %>% select(gage,dec_lat_va,dec_long_va,CLASS,Name) %>% left_join(k.means,.,by="gage") %>% unique()
k.means = df %>% select(gage,dec_lat_va,dec_long_va,CLASS,Name) %>% left_join(k.means,.,by="gage") %>% unique()
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
# geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion),alpha=1)+
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),colour = factor(mode), size = proportion),alpha=.7)+
scale_color_manual(name = "Cluster Membership Mode",values = cols)+
# scale_radius(trans='sqrt',breaks = c(.2,.4,.6,.8,1),labels = c(5,4,3,2,1),name = "Number of Cluster Changes") +
scale_shape(name="Gage Type")+
ggtitle("k-means")
kmean_CLUST
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
# geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion),alpha=1)+
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),colour = factor(mode), size = 1/proportion),alpha=.7)+
scale_color_manual(name = "Cluster Membership Mode",values = cols)+
# scale_radius(trans='sqrt',breaks = c(.2,.4,.6,.8,1),labels = c(5,4,3,2,1),name = "Number of Cluster Changes") +
scale_shape(name="Gage Type")+
ggtitle("k-means")
kmean_CLUST
prop = df %>% group_by(gage,kmeans,n) %>% summarise(kmeans.count = n())
k.means  = df  %>% group_by(gage) %>% summarise(kmeans.mode = mode(kmeans),
kmeans.unique = n_distinct(kmeans))
k.means = k.means %>% left_join(.,prop,by=c("gage","kmeans.mode"="kmeans"))
View(k.means)
mode <- function(x) {
ux <- unique(x)
ux[which.max(tabulate(match(x, ux)))]
}
prop = df %>% group_by(gage,kmeans,n) %>% summarise(kmeans.count = n())
View(prop)
prop$prop = prop$kmeans.count/prop$n
colnames(prop)  = c("gage",'cluster','total_events','event_count','proportion')
k.means = df %>% select(gage,dec_lat_va,dec_long_va,CLASS,Name) %>% left_join(prop,.,by="gage") %>% unique()
View(k.means)
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
# geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion),alpha=1)+
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),colour = cluster, size = proportion),alpha=1)+
scale_color_manual(name = "Cluster Membership Mode",values = cols)+
# scale_radius(trans='sqrt',breaks = c(.2,.4,.6,.8,1),labels = c(5,4,3,2,1),name = "Number of Cluster Changes") +
scale_shape(name="Gage Type")+
ggtitle("k-means")
kmean_CLUST + facet_wrap(clusters ~. , nrow=2)
kmean_CLUST
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
# geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion),alpha=1)+
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),colour = factor(cluster), size = proportion),alpha=1)+
scale_color_manual(name = "Cluster Membership Mode",values = cols)+
# scale_radius(trans='sqrt',breaks = c(.2,.4,.6,.8,1),labels = c(5,4,3,2,1),name = "Number of Cluster Changes") +
scale_shape(name="Gage Type")+
ggtitle("k-means")
kmean_CLUST
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
# geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion),alpha=1)+
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),colour = factor(cluster), size = proportion),alpha=1)+
scale_color_manual(name = "Cluster Membership Mode",values = cols)+
# scale_radius(trans='sqrt',breaks = c(.2,.4,.6,.8,1),labels = c(5,4,3,2,1),name = "Number of Cluster Changes") +
scale_shape(name="Gage Type")+
ggtitle("k-means")
kmean_CLUST + facet_wrap(clusters ~. , nrow=2)
kmean_CLUST + facet_wrap(~clusters , nrow=2)
kmean_CLUST + facet_grid(rows=clusters)
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
# geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion),alpha=1)+
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),colour = factor(cluster), size = proportion),alpha=1)+
scale_color_manual(name = "Cluster Membership Mode",values = cols)+
# scale_radius(trans='sqrt',breaks = c(.2,.4,.6,.8,1),labels = c(5,4,3,2,1),name = "Number of Cluster Changes") +
scale_shape(name="Gage Type")+
ggtitle("k-means")+
facet_wrap(~cluster)
kmean_CLUST
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion+.1),alpha=1)+
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),colour = factor(cluster), size = proportion),alpha=1)+
scale_color_manual(name = "Cluster Membership Mode",values = cols)+
# scale_radius(trans='sqrt',breaks = c(.2,.4,.6,.8,1),labels = c(5,4,3,2,1),name = "Number of Cluster Changes") +
scale_shape(name="Gage Type")+
ggtitle("k-means")+
facet_wrap(~cluster)
kmean_CLUST
scale_radius
?scale_radius
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion+.1),alpha=1)+
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),colour = factor(cluster), size = proportion),alpha=1)+
scale_color_manual(name = "Cluster Membership Mode",values = cols)+
# scale_radius(trans='sqrt',breaks = c(.2,.4,.6,.8,1),labels = c(5,4,3,2,1),name = "Number of Cluster Changes") +
scale_radius(limits = c(.1,.5),name = "Number of Cluster Changes")
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion+.1),alpha=1)+
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),colour = factor(cluster), size = proportion),alpha=1)+
scale_color_manual(name = "Cluster Membership Mode",values = cols)+
# scale_radius(trans='sqrt',breaks = c(.2,.4,.6,.8,1),labels = c(5,4,3,2,1),name = "Number of Cluster Changes") +
scale_radius(limits = c(.1,.5),name = "Number of Cluster Changes")
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion+.1),alpha=1)+
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),colour = factor(cluster), size = proportion),alpha=1)+
scale_color_manual(name = "Cluster Membership Mode",values = cols)+
# scale_radius(trans='sqrt',breaks = c(.2,.4,.6,.8,1),labels = c(5,4,3,2,1),name = "Number of Cluster Changes") +
scale_radius(limits = c(.1,.5),name = "Number of Cluster Changes")+
scale_shape(name="Gage Type")+
ggtitle("k-means")+
facet_wrap(~cluster)
kmean_CLUST
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion +.1),alpha=1)
kmean_CLUST
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion +.1),alpha=1)+
facet_wrap(~cluster)
kmean_CLUST
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion +.1),alpha=1)+
scale_radius(limits = c(.1,.5),name = "Number of Cluster Changes")+
facet_wrap(~cluster)
kmean_CLUST
kmean_CLUST +   geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),colour = factor(cluster), size = proportion),alpha=1)+
scale_color_manual(name = "Cluster Membership Mode",values = cols)+
# scale_radius(trans='sqrt',breaks = c(.2,.4,.6,.8,1),labels = c(5,4,3,2,1),name = "Number of Cluster Changes") +
scale_radius(limits = c(.1,.5),name = "Number of Cluster Changes")+
scale_shape(name="Gage Type")+
ggtitle("k-means")+
facet_wrap(~cluster)
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion),alpha=1)+
scale_radius(limits = c(.1,.5),name = "Number of Cluster Changes")+
facet_wrap(~cluster)
kmean_CLUST
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion),alpha=1)+
scale_radius(trans = 'sqrt',limits = c(.1,.5),name = "Number of Cluster Changes")+
facet_wrap(~cluster)
kmean_CLUST
kmean_CLUST +   geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),colour = factor(cluster), size = proportion),alpha=1)+
scale_color_manual(name = "Cluster Membership Mode",values = cols)+
# scale_radius(trans='sqrt',breaks = c(.2,.4,.6,.8,1),labels = c(5,4,3,2,1),name = "Number of Cluster Changes") +
scale_radius(trans = 'sqrt',limits = c(.1,.5),name = "Number of Cluster Changes")+
scale_shape(name="Gage Type")+
ggtitle("k-means")+
facet_wrap(~cluster)
kmean_CLUST +   geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),colour = factor(cluster), size = proportion),alpha=.7)+
scale_color_manual(name = "Cluster Membership Mode",values = cols)+
# scale_radius(trans='sqrt',breaks = c(.2,.4,.6,.8,1),labels = c(5,4,3,2,1),name = "Number of Cluster Changes") +
scale_radius(trans = 'sqrt',limits = c(.1,.5),name = "Number of Cluster Changes")+
scale_shape(name="Gage Type")+
ggtitle("k-means")+
facet_wrap(~cluster)
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion+0.01),alpha=1)+
scale_radius(trans = 'sqrt',limits = c(.1,.5),name = "Number of Cluster Changes")+
facet_wrap(~cluster)
kmean_CLUST +   geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),colour = factor(cluster), size = proportion),alpha=.7)+
scale_color_manual(name = "Cluster Membership Mode",values = cols)+
# scale_radius(trans='sqrt',breaks = c(.2,.4,.6,.8,1),labels = c(5,4,3,2,1),name = "Number of Cluster Changes") +
scale_radius(trans = 'sqrt',limits = c(.1,.5),name = "Number of Cluster Changes")+
scale_shape(name="Gage Type")+
ggtitle("k-means")+
facet_wrap(~cluster)
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion+0.01),alpha=1)+
scale_radius(trans = 'sqrt',limits = c(.1,.5),name = "Proportion of Events in Cluster")+
facet_wrap(~cluster)
kmean_CLUST +   geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),colour = factor(cluster), size = proportion),alpha=.7)+
scale_color_manual(name = "Cluster Membership Mode",values = cols)+
# scale_radius(trans='sqrt',breaks = c(.2,.4,.6,.8,1),labels = c(5,4,3,2,1),name = "Number of Cluster Changes") +
scale_radius(trans = 'sqrt',limits = c(.1,.5),name = "Proportion of Events in Cluster")+
scale_shape(name="Gage Type")+
ggtitle("k-means")+
facet_wrap(~cluster)
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion+0.01),alpha=1)+
scale_radius(trans = 'sqrt',limits = c(.1,.5),name = "Proportion of Events in Cluster")+
facet_wrap(~cluster)
kmean_CLUST +   geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),colour = factor(cluster), size = proportion),alpha=.7)+
scale_color_manual(values = cols)+
# scale_radius(trans='sqrt',breaks = c(.2,.4,.6,.8,1),labels = c(5,4,3,2,1),name = "Number of Cluster Changes") +
scale_radius(trans = 'sqrt',limits = c(.1,.5),name = "Proportion of Events in Cluster")+
scale_shape(name="Gage Type")+
ggtitle("k-means")+
facet_wrap(~cluster)
kmean_CLUST <- ggplot(data = states) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "gray", color = "black") +
coord_fixed(1.3, xlim = c(-124.25,-70), ylim = c(26,48.5)) +
theme_linedraw() +
geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),size = proportion+0.01),alpha=.25)+
scale_radius(trans = 'sqrt',limits = c(.1,.5),name = "Proportion of Events in Cluster")+
facet_wrap(~cluster)
kmean_CLUST +   geom_point(data=k.means, aes(x=dec_long_va, y=dec_lat_va, shape = factor(CLASS),colour = factor(cluster), size = proportion),alpha=.7)+
scale_color_manual(values = cols)+
# scale_radius(trans='sqrt',breaks = c(.2,.4,.6,.8,1),labels = c(5,4,3,2,1),name = "Number of Cluster Changes") +
scale_radius(trans = 'sqrt',limits = c(.1,.5),name = "Proportion of Events in Cluster")+
scale_shape(name="Gage Type")+
ggtitle("k-means")+
facet_wrap(~cluster)
summary(df$CLASS)
summary(k.means$proportion)
summary(k.means)
